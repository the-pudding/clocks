import{n as te,s as le,e as re,f as oe,h as R,i as V,r as fe,b as ue}from"../chunks/scheduler.b5ae7a1c.js";import{S as ce,i as _e,r as pe,s as S,g as N,e as j,u as de,c as B,h as A,z as se,k as g,v as me,a as C,d as he,t as ve,f as m,w as ke,m as L,j as P,n as U,y as w,o as I,A as ye,C as G,B as be}from"../chunks/index.f51f2042.js";import{M as we,v as ge,e as W,c as X}from"../chunks/version.e8e441f6.js";import{c as Ce,a as Ee}from"../chunks/clock.d10aa51e.js";const Ne=typeof window<"u";let Ae=Ne?l=>requestAnimationFrame(l):te;function Y(l,e,i){const t=l.slice();t[22]=e[i].text,t[23]=e[i].highlight;const n=t[23]?"mark":"span";return t[24]=n,t}function Z(l){let e,i,t,n,r,a,o,d,k,u,c=l[3].artist+"",p,M,s,h,T,F=W(l[4]),v=[];for(let f=0;f<F.length;f+=1)v[f]=$(Y(l,F,f));return{c(){e=N("time"),i=L(l[1]),t=S(),n=L(l[5]),r=S(),a=N("h1"),o=N("span");for(let f=0;f<v.length;f+=1)v[f].c();d=S(),k=N("span"),u=L("By "),p=L(c),M=S(),s=N("a"),h=L("link"),this.h()},l(f){e=A(f,"TIME",{class:!0});var y=P(e);i=U(y,l[1]),t=B(y),n=U(y,l[5]),y.forEach(m),r=B(f),a=A(f,"H1",{class:!0});var _=P(a);o=A(_,"SPAN",{class:!0});var O=P(o);for(let E=0;E<v.length;E+=1)v[E].l(O);O.forEach(m),d=B(_),k=A(_,"SPAN",{class:!0});var q=P(k);u=U(q,"By "),p=U(q,c),M=B(q),s=A(q,"A",{href:!0,target:!0,rel:!0});var b=P(s);h=U(b,"link"),b.forEach(m),q.forEach(m),_.forEach(m),this.h()},h(){g(e,"class","svelte-rvsehe"),g(o,"class","title svelte-rvsehe"),g(s,"href",T=l[3].href),g(s,"target","_blank"),g(s,"rel","noreferrer"),g(k,"class","artist svelte-rvsehe"),g(a,"class","svelte-rvsehe")},m(f,y){C(f,e,y),w(e,i),w(e,t),w(e,n),C(f,r,y),C(f,a,y),w(a,o);for(let _=0;_<v.length;_+=1)v[_]&&v[_].m(o,null);w(a,d),w(a,k),w(k,u),w(k,p),w(k,M),w(k,s),w(s,h)},p(f,y){if(y&2&&I(i,f[1]),y&32&&I(n,f[5]),y&16){F=W(f[4]);let _;for(_=0;_<F.length;_+=1){const O=Y(f,F,_);v[_]?v[_].p(O,y):(v[_]=$(O),v[_].c(),v[_].m(o,null))}for(;_<v.length;_+=1)v[_].d(1);v.length=F.length}y&8&&c!==(c=f[3].artist+"")&&I(p,c),y&8&&T!==(T=f[3].href)&&g(s,"href",T)},d(f){f&&(m(e),m(r),m(a)),ye(v,f)}}}function H(l){let e,i=l[22]+"",t;return{c(){e=N(l[24]),t=L(i),this.h()},l(n){e=A(n,(l[24]||"null").toUpperCase(),{class:!0});var r=P(e);t=U(r,i),r.forEach(m),this.h()},h(){be(l[24])(e,{class:"svelte-rvsehe"})},m(n,r){C(n,e,r),w(e,t)},p(n,r){r&16&&i!==(i=n[22]+"")&&I(t,i)},d(n){n&&m(e)}}}function $(l){let e=l[24],i,t=l[24]&&H(l);return{c(){t&&t.c(),i=j()},l(n){t&&t.l(n),i=j()},m(n,r){t&&t.m(n,r),C(n,i,r)},p(n,r){n[24]?e?le(e,n[24])?(t.d(1),t=H(n),e=n[24],t.c(),t.m(i.parentNode,i)):t.p(n,r):(t=H(n),e=n[24],t.c(),t.m(i.parentNode,i)):e&&(t.d(1),t=null,e=n[24])},d(n){n&&m(i),t&&t.d(n)}}}function x(l){let e,i,t="Enable Audio",n,r;return{c(){e=N("p"),i=N("button"),i.textContent=t,this.h()},l(a){e=A(a,"P",{class:!0});var o=P(e);i=A(o,"BUTTON",{"data-svelte-h":!0}),se(i)!=="svelte-1sl3zi7"&&(i.textContent=t),o.forEach(m),this.h()},h(){g(e,"class","svelte-rvsehe")},m(a,o){C(a,e,o),w(e,i),n||(r=G(i,"click",l[11]),n=!0)},p:te,d(a){a&&m(e),n=!1,r()}}}function ee(l){let e,i,t,n,r;function a(){cancelAnimationFrame(t),e.paused||(t=Ae(a)),l[14].call(e)}return{c(){e=N("audio"),this.h()},l(o){e=A(o,"AUDIO",{src:!0,preload:!0}),P(e).forEach(m),this.h()},h(){R(e.src,i=l[3].preview_url)||g(e,"src",i),g(e,"preload",""),e.autoplay=!0,l[0]===void 0&&V(a),l[0]===void 0&&V(()=>l[15].call(e))},m(o,d){C(o,e,d),l[16](e),n||(r=[G(e,"timeupdate",a),G(e,"ended",l[15])],n=!0)},p(o,d){d&8&&!R(e.src,i=o[3].preview_url)&&g(e,"src",i)},d(o){o&&m(e),l[16](null),n=!1,fe(r)}}}function Te(l){var M;let e,i,t,n="This is a clock where the time is in the title of a song.",r,a,o,d,k;e=new we({props:{title:l[7],description:l[8],url:l[9],preloadFont:l[6],keywords:l[10]}});let u=l[3]&&Z(l),c=l[2]&&x(l),p=((M=l[3])==null?void 0:M.preview_url)&&ee(l);return{c(){pe(e.$$.fragment),i=S(),t=N("p"),t.textContent=n,r=S(),u&&u.c(),a=S(),c&&c.c(),o=S(),p&&p.c(),d=j(),this.h()},l(s){de(e.$$.fragment,s),i=B(s),t=A(s,"P",{class:!0,"data-svelte-h":!0}),se(t)!=="svelte-1rtwy5v"&&(t.textContent=n),r=B(s),u&&u.l(s),a=B(s),c&&c.l(s),o=B(s),p&&p.l(s),d=j(),this.h()},h(){g(t,"class","svelte-rvsehe")},m(s,h){me(e,s,h),C(s,i,h),C(s,t,h),C(s,r,h),u&&u.m(s,h),C(s,a,h),c&&c.m(s,h),C(s,o,h),p&&p.m(s,h),C(s,d,h),k=!0},p(s,[h]){var T;s[3]?u?u.p(s,h):(u=Z(s),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null),s[2]?c?c.p(s,h):(c=x(s),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),(T=s[3])!=null&&T.preview_url?p?p.p(s,h):(p=ee(s),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},i(s){k||(he(e.$$.fragment,s),k=!0)},o(s){ve(e.$$.fragment,s),k=!1},d(s){s&&(m(i),m(t),m(r),m(a),m(o),m(d)),ke(e,s),u&&u.d(s),c&&c.d(s),p&&p.d(s)}}}function Fe(l,e,i){let t,n,r;re(l,Ee,b=>i(13,r=b)),ge();let a,o,d,k,u;const c=[],{title:p,description:M,url:s,keywords:h}=X;oe("copy",X);function T(b){const E=b.toLowerCase(),z=n.toLowerCase(),K=E.indexOf(`${t} ${z}`)>-1?`${t} ${z}`:t,D=E.indexOf(K),Q=D+K.length,ie=b.slice(0,D),ne=b.slice(D,Q),ae=b.slice(Q);return[{text:ie},{text:ne,highlight:!0},{text:ae}]}function F(){const b=o.filter(J=>J.time===t),E=Math.floor(Math.random()*b.length),z=d==null?void 0:d.id;i(3,d={...b[E]}),z===d.id&&(i(2,a.currentTime=0,a),a.play()),i(4,k=T(d.name))}function v(){F()}async function f(){const b=await Ce("../assets/tracks.csv");i(12,o=b.map(E=>({...E,popularity:+E.popularity})))}function y(){a.play()}function _(){u=this.ended,i(0,u)}function O(){u=this.ended,i(0,u)}function q(b){ue[b?"unshift":"push"](()=>{a=b,i(2,a)})}return l.$$.update=()=>{l.$$.dirty&8192&&i(1,t=r.time),l.$$.dirty&8192&&i(5,n=r.period),l.$$.dirty&4098&&o&&v(),l.$$.dirty&1&&u&&F()},f(),[u,t,a,d,k,n,c,p,M,s,h,y,o,r,_,O,q]}class qe extends ce{constructor(e){super(),_e(this,e,Fe,Te,le,{})}}export{qe as component};
