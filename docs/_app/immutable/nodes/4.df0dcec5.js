import{v as V,s as ee,f as O,g as P,h as S,d as m,j as N,i as E,D as be,e as fe,l as B,m as L,u as C,n as H,a as M,c as D,F as ue,G as ce,I as Pe,J as de,K as Z,L as j,M as Me,N as De,A as Ee,o as Se,p as te,O as Fe,C as je,B as Ie,P as Be}from"../chunks/scheduler.a3ab7b7f.js";import{S as ne,i as re,f as Le,b as W,d as G,m as J,a as F,t as I,c as qe,e as R,g as ze}from"../chunks/index.adf03280.js";import{c as Ke,a as Ue}from"../chunks/clock.4d37f157.js";import{e as X,M as We,W as Ge,v as Je,c as pe}from"../chunks/version.68fb5f88.js";import{T as Re}from"../chunks/Title.e1c9e251.js";import{w as Ve}from"../chunks/index.f2d92702.js";const ve=typeof window<"u";let He=ve?()=>window.performance.now():()=>Date.now(),se=ve?t=>requestAnimationFrame(t):V;const U=new Set;function Ae(t){U.forEach(e=>{e.c(t)||(U.delete(e),e.f())}),U.size!==0&&se(Ae)}function Qe(t){let e;return U.size===0&&se(Ae),{promise:new Promise(r=>{U.add(e={c:t,f:r})}),abort(){U.delete(e)}}}const Xe=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function _e(t,e,r){const i=t.slice();return i[1]=e[r].text,i[2]=e[r].mark,i}function me(t,e,r){const i=t.slice();i[5]=e[r];const n=i[5]===":";return i[6]=n,i}function Ye(t){let e,r=t[1]+"",i;return{c(){e=O("span"),i=B(r),this.h()},l(n){e=P(n,"SPAN",{class:!0});var s=S(e);i=L(s,r),s.forEach(m),this.h()},h(){N(e,"class","svelte-4nvwp7")},m(n,s){E(n,e,s),C(e,i)},p(n,s){s&1&&r!==(r=n[1]+"")&&H(i,r)},d(n){n&&m(e)}}}function Ze(t){let e,r,i=X(t[1]),n=[];for(let s=0;s<i.length;s+=1)n[s]=he(me(t,i,s));return{c(){e=O("mark");for(let s=0;s<n.length;s+=1)n[s].c();r=M(),this.h()},l(s){e=P(s,"MARK",{class:!0});var o=S(e);for(let a=0;a<n.length;a+=1)n[a].l(o);r=D(o),o.forEach(m),this.h()},h(){N(e,"class","svelte-4nvwp7")},m(s,o){E(s,e,o);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null);C(e,r)},p(s,o){if(o&1){i=X(s[1]);let a;for(a=0;a<i.length;a+=1){const u=me(s,i,a);n[a]?n[a].p(u,o):(n[a]=he(u),n[a].c(),n[a].m(e,r))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},d(s){s&&m(e),be(n,s)}}}function he(t){let e,r=t[5]+"",i;return{c(){e=O("span"),i=B(r),this.h()},l(n){e=P(n,"SPAN",{class:!0});var s=S(e);i=L(s,r),s.forEach(m),this.h()},h(){N(e,"class","svelte-4nvwp7"),ue(e,"colon",t[6])},m(n,s){E(n,e,s),C(e,i)},p(n,s){s&1&&r!==(r=n[5]+"")&&H(i,r),s&1&&ue(e,"colon",n[6])},d(n){n&&m(e)}}}function ge(t){let e;function r(s,o){return s[2]?Ze:Ye}let i=r(t),n=i(t);return{c(){n.c(),e=fe()},l(s){n.l(s),e=fe()},m(s,o){n.m(s,o),E(s,e,o)},p(s,o){i===(i=r(s))&&n?n.p(s,o):(n.d(1),n=i(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&m(e),n.d(s)}}}function $e(t){let e,r=X(t[0]),i=[];for(let n=0;n<r.length;n+=1)i[n]=ge(_e(t,r,n));return{c(){e=O("p");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){e=P(n,"P",{class:!0});var s=S(e);for(let o=0;o<i.length;o+=1)i[o].l(s);s.forEach(m),this.h()},h(){N(e,"class","svelte-4nvwp7")},m(n,s){E(n,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(n,[s]){if(s&1){r=X(n[0]);let o;for(o=0;o<r.length;o+=1){const a=_e(n,r,o);i[o]?i[o].p(a,s):(i[o]=ge(a),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}},i:V,o:V,d(n){n&&m(e),be(i,n)}}}function xe(t,e,r){let{data:i}=e;return t.$$set=n=>{"data"in n&&r(0,i=n.data)},[i]}class et extends ne{constructor(e){super(),re(this,e,xe,$e,ee,{data:0})}}function ye(t){return Object.prototype.toString.call(t)==="[object Date]"}function x(t,e){if(t===e||t!==t)return()=>t;const r=typeof t;if(r!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const i=e.map((n,s)=>x(t[s],n));return n=>i.map(s=>s(n))}if(r==="object"){if(!t||!e)throw new Error("Object cannot be null");if(ye(t)&&ye(e)){t=t.getTime(),e=e.getTime();const s=e-t;return o=>new Date(t+o*s)}const i=Object.keys(e),n={};return i.forEach(s=>{n[s]=x(t[s],e[s])}),s=>{const o={};return i.forEach(a=>{o[a]=n[a](s)}),o}}if(r==="number"){const i=e-t;return n=>t+n*i}throw new Error(`Cannot interpolate ${r} values`)}function tt(t,e={}){const r=Ve(t);let i,n=t;function s(o,a){if(t==null)return r.set(t=o),Promise.resolve();n=o;let u=i,f=!1,{delay:_=0,duration:y=400,easing:h=Pe,interpolate:d=x}=ce(ce({},e),a);if(y===0)return u&&(u.abort(),u=null),r.set(t=n),Promise.resolve();const g=He()+_;let w;return i=Qe(v=>{if(v<g)return!0;f||(w=d(t,o),typeof y=="function"&&(y=y(t,o)),f=!0),u&&(u.abort(),u=null);const c=v-g;return c>y?(r.set(t=o),!1):(r.set(t=w(h(c/y))),!0)}),i.promise}return{set:s,update:(o,a)=>s(o(n,t),a),subscribe:r.subscribe}}const{isNaN:$}=Xe;function nt(t){let e,r,i=!1,n,s=!0,o,a;function u(){cancelAnimationFrame(n),e.paused||(n=se(u),i=!0),t[14].call(e)}return{c(){e=O("audio"),this.h()},l(f){e=P(f,"AUDIO",{src:!0,preload:!0}),S(e).forEach(m),this.h()},h(){de(e.src,r=t[0])||N(e,"src",r),N(e,"preload",""),e.autoplay=!0,(t[1]===void 0||t[2]===void 0)&&Z(u),t[1]===void 0&&Z(()=>t[15].call(e)),t[5]===void 0&&Z(()=>t[18].call(e))},m(f,_){E(f,e,_),$(t[4])||(e.volume=t[4]),e.muted=t[6],t[19](e),o||(a=[j(e,"timeupdate",u),j(e,"ended",t[15]),j(e,"volumechange",t[16]),j(e,"play",t[17]),j(e,"pause",t[17]),j(e,"durationchange",t[18])],o=!0)},p(f,[_]){_&1&&!de(e.src,r=f[0])&&N(e,"src",r),!i&&_&4&&!$(f[2])&&(e.currentTime=f[2]),i=!1,_&16&&!$(f[4])&&(e.volume=f[4]),_&64&&(e.muted=f[6]),_&128&&s!==(s=f[7])&&e[s?"pause":"play"]()},i:V,o:V,d(f){f&&m(e),t[19](null),o=!1,Me(a)}}}function rt(t,e,r){let i,n,{src:s}=e,{ready:o}=e,a=new Date,u,f,_,y,h,d,g,w;const v=De(),c=tt(0);Ee(t,c,A=>r(13,n=A));const b=()=>{u&&(r(2,y=0),u.play(),r(4,_=1),console.log("fade in"),c.set(0),c.set(1,{duration:500}))};function q(A){w=!0,console.log("fade out",A),c.set(0,{duration:500}).then(()=>{w=!1,A&&u.pause()})}function z(){w||g===!1&&i===59&&q(!0)}function K(){if(w||isNaN(h))return;const A=h-y<1;g===!1&&A&&q()}Se(()=>{setInterval(()=>{r(11,a=new Date)},500),r(9,o=!0)});function l(){f=this.ended,y=this.currentTime,r(1,f),r(2,y)}function p(){f=this.ended,r(1,f)}function k(){_=this.volume,d=this.muted,r(4,_),r(13,n),r(6,d)}function T(){g=this.paused,r(7,g)}function Q(){h=this.duration,r(5,h)}function ie(A){te[A?"unshift":"push"](()=>{u=A,r(3,u)})}return t.$$set=A=>{"src"in A&&r(0,s=A.src),"ready"in A&&r(9,o=A.ready)},t.$$.update=()=>{t.$$.dirty&2&&f&&v("ended"),t.$$.dirty&2048&&r(12,i=a.getSeconds()),t.$$.dirty&4096&&z(),t.$$.dirty&4&&K(),t.$$.dirty&8192&&r(4,_=n)},[s,f,y,u,_,h,d,g,c,o,b,a,i,n,l,p,k,T,Q,ie]}class st extends ne{constructor(e){super(),re(this,e,rt,nt,ee,{src:0,ready:9,play:10})}get play(){return this.$$.ctx[10]}}function ke(t){let e,r,i,n,s,o=t[0].artist+"",a,u,f,_,y,h;return r=new et({props:{data:t[4]}}),{c(){e=O("div"),W(r.$$.fragment),i=M(),n=O("p"),s=B("By "),a=B(o),u=M(),f=O("a"),_=B("link"),this.h()},l(d){e=P(d,"DIV",{class:!0});var g=S(e);G(r.$$.fragment,g),g.forEach(m),i=D(d),n=P(d,"P",{class:!0});var w=S(n);s=L(w,"By "),a=L(w,o),u=D(w),f=P(w,"A",{href:!0,target:!0,rel:!0});var v=S(f);_=L(v,"link"),v.forEach(m),w.forEach(m),this.h()},h(){N(e,"class","clock"),N(f,"href",y=t[0].href),N(f,"target","_blank"),N(f,"rel","noreferrer"),N(n,"class","artist svelte-1f29337")},m(d,g){E(d,e,g),J(r,e,null),E(d,i,g),E(d,n,g),C(n,s),C(n,a),C(n,u),C(n,f),C(f,_),h=!0},p(d,g){const w={};g&16&&(w.data=d[4]),r.$set(w),(!h||g&1)&&o!==(o=d[0].artist+"")&&H(a,o),(!h||g&1&&y!==(y=d[0].href))&&N(f,"href",y)},i(d){h||(F(r.$$.fragment,d),h=!0)},o(d){I(r.$$.fragment,d),h=!1},d(d){d&&(m(e),m(i),m(n)),R(r)}}}function we(t){let e,r,i="Enable Audio",n,s;return{c(){e=O("p"),r=O("button"),r.textContent=i,this.h()},l(o){e=P(o,"P",{class:!0});var a=S(e);r=P(a,"BUTTON",{"data-svelte-h":!0}),Ie(r)!=="svelte-mf5j6b"&&(r.textContent=i),a.forEach(m),this.h()},h(){N(e,"class","svelte-1f29337")},m(o,a){E(o,e,a),C(e,r),n||(s=j(r,"click",function(){Be(t[3].play)&&t[3].play.apply(this,arguments)}),n=!0)},p(o,a){t=o},d(o){o&&m(e),n=!1,s()}}}function it(t){var K;let e,r,i,n,s,o,a,u,f,_,y,h,d,g,w,v;e=new We({props:{title:t[7],description:t[8],url:t[9],preloadFont:t[6],keywords:t[10]}}),i=new Ge({}),s=new Re({props:{text:"a clock where the time appears in a song title"}});let c=t[0]&&ke(t),b=t[1]&&we(t);function q(l){t[14](l)}let z={src:(K=t[0])==null?void 0:K.preview_url};return t[1]!==void 0&&(z.ready=t[1]),f=new st({props:z}),te.push(()=>Le(f,"ready",q)),t[15](f),f.$on("ended",t[16]),{c(){W(e.$$.fragment),r=M(),W(i.$$.fragment),n=M(),W(s.$$.fragment),o=M(),c&&c.c(),a=M(),b&&b.c(),u=M(),W(f.$$.fragment),y=M(),h=O("time"),d=B(t[2]),g=M(),w=B(t[5]),this.h()},l(l){G(e.$$.fragment,l),r=D(l),G(i.$$.fragment,l),n=D(l),G(s.$$.fragment,l),o=D(l),c&&c.l(l),a=D(l),b&&b.l(l),u=D(l),G(f.$$.fragment,l),y=D(l),h=P(l,"TIME",{class:!0});var p=S(h);d=L(p,t[2]),g=D(p),w=L(p,t[5]),p.forEach(m),this.h()},h(){N(h,"class","svelte-1f29337")},m(l,p){J(e,l,p),E(l,r,p),J(i,l,p),E(l,n,p),J(s,l,p),E(l,o,p),c&&c.m(l,p),E(l,a,p),b&&b.m(l,p),E(l,u,p),J(f,l,p),E(l,y,p),E(l,h,p),C(h,d),C(h,g),C(h,w),v=!0},p(l,[p]){var T;l[0]?c?(c.p(l,p),p&1&&F(c,1)):(c=ke(l),c.c(),F(c,1),c.m(a.parentNode,a)):c&&(ze(),I(c,1,1,()=>{c=null}),qe()),l[1]?b?b.p(l,p):(b=we(l),b.c(),b.m(u.parentNode,u)):b&&(b.d(1),b=null);const k={};p&1&&(k.src=(T=l[0])==null?void 0:T.preview_url),!_&&p&2&&(_=!0,k.ready=l[1],Fe(()=>_=!1)),f.$set(k),(!v||p&4)&&H(d,l[2]),(!v||p&32)&&H(w,l[5])},i(l){v||(F(e.$$.fragment,l),F(i.$$.fragment,l),F(s.$$.fragment,l),F(c),F(f.$$.fragment,l),v=!0)},o(l){I(e.$$.fragment,l),I(i.$$.fragment,l),I(s.$$.fragment,l),I(c),I(f.$$.fragment,l),v=!1},d(l){l&&(m(r),m(n),m(o),m(a),m(u),m(y),m(h)),R(e,l),R(i,l),R(s,l),c&&c.d(l),b&&b.d(l),t[15](null),R(f,l)}}}function ot(t,e,r){let i,n,s,o;Ee(t,Ue,k=>r(13,o=k)),Je();let a,u,f,_;const y=[],{title:h,description:d,url:g,keywords:w}=pe;je("copy",pe);function v(k){if(!k)return;const T=k.toLowerCase(),Q=n.toLowerCase(),oe=T.indexOf(`${i} ${Q}`)>-1?`${i} ${Q}`:i,Y=T.indexOf(oe),le=Y+oe.length,Ne=k.slice(0,Y),ae=k.slice(Y,le),Te=ae.split(":")[0],Ce=ae.split(":")[1],Oe=k.slice(le);return[{text:Ne},{mark:!0,text:[Te,":",Ce]},{text:Oe}]}function c(){r(0,u={name:i,artist:"No Track Found",href:""}),audioEl&&(audioEl.pause(),audioEl.currentTime=0)}function b(){const k=a.filter(T=>T.time===i);if(!k.length)c();else{const T=Math.floor(Math.random()*k.length);u==null||u.id,r(0,u={...k[T]}),f.play()}}function q(){b()}async function z(){const k=await Ke("../assets/tracks.csv");r(12,a=k.map(T=>({...T,popularity:+T.popularity})))}function K(k){_=k,r(1,_)}function l(k){te[k?"unshift":"push"](()=>{f=k,r(3,f)})}const p=()=>b();return t.$$.update=()=>{t.$$.dirty&8192&&r(2,i=o.time),t.$$.dirty&8192&&r(5,n=o.period),t.$$.dirty&4102&&a&&_&&q(),t.$$.dirty&1&&r(4,s=v(u==null?void 0:u.name))},z(),[u,_,i,f,s,n,y,h,d,g,w,b,a,o,K,l,p]}class pt extends ne{constructor(e){super(),re(this,e,ot,it,ee,{})}}export{pt as component};
